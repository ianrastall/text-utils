<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Tag Remover â€“ Text Utils</title>
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body class="bg-dark text-light">
    <div id="header"></div>
    <div class="container-fluid my-4">
        <div class="row gx-3 gy-3">
            <main class="col-md-9">
                <div class="card bg-dark border-secondary">
                    <div class="card-body">
                        <h2 class="card-title mb-4 d-flex align-items-center">
                            <span class="material-icons me-3" style="font-size: 36px;" aria-hidden="true">code_off</span>
                            HTML Tag Remover
                        </h2>
                        <div class="post-content">
                            <form onsubmit="return false;">
                                <div class="mb-3">
                                    <label for="mainText" class="form-label">HTML Content</label>
                                    <textarea class="form-control font-monospace" id="mainText" rows="12" placeholder="Paste HTML content here..." autofocus></textarea>
                                </div>
                                <div class="d-flex gap-2 flex-wrap mb-3 align-items-center">
                                    <button type="button" class="btn btn-task d-flex align-items-center" id="stripBtn">
                                        <span class="material-icons me-2" aria-hidden="true">code_off</span>Strip HTML Tags
                                    </button>
                                    <button type="button" class="btn btn-task d-flex align-items-center" id="trimLinesBtn">
                                        <span class="material-icons me-2" aria-hidden="true">compress</span>Trim Blank Lines
                                    </button>
                                    <button type="button" class="btn btn-task d-flex align-items-center" id="removeAttrsBtn">
                                        <span class="material-icons me-2" aria-hidden="true">remove_circle</span>Remove All Attributes
                                    </button>
                                    <button type="button" class="btn btn-task d-flex align-items-center" id="minifyBtn">
                                        <span class="material-icons me-2" aria-hidden="true">format_align_left</span>Minify
                                    </button>
                                    <button type="button" class="btn btn-edit d-flex align-items-center" id="pasteBtn">
                                         <span class="material-icons me-2" aria-hidden="true">content_paste</span>Paste
                                    </button>
                                    <button type="button" class="btn btn-edit d-flex align-items-center" id="copyBtn">
                                         <span class="material-icons me-2" aria-hidden="true">content_copy</span>Copy Result
                                    </button>
                                    <button type="button" class="btn btn-clear d-flex align-items-center" id="clearBtn">
                                         <span class="material-icons me-2" aria-hidden="true">clear</span>Clear
                                    </button>
                                </div>
                                <div class="d-flex flex-wrap gap-3 align-items-center">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" role="switch" id="autoStripOnPaste">
                                        <label class="form-check-label" for="autoStripOnPaste">Auto-strip on paste</label>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" role="switch" id="autoTrimAfterStrip">
                                        <label class="form-check-label" for="autoTrimAfterStrip">Trim blank lines after stripping</label>
                                    </div>
                                </div>
                                <div id="resultInfo" class="text-muted mt-3" style="min-height: 1.5em;" aria-live="polite"></div>
                            </form>
                        </div>
                    </div>
                </div>
            </main>
            <aside class="col-md-3">
                <div class="card bg-dark border-secondary">
                    <div class="card-body p-0">
                        <div id="sidebar"></div>
                    </div>
                </div>
            </aside>
        </div>
    </div>
    <div id="footer"></div>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/component-loader.js"></script>
    <script src="js/main.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        'use strict';
        const mainText = document.getElementById('mainText');
        const stripBtn = document.getElementById('stripBtn');
        const trimLinesBtn = document.getElementById('trimLinesBtn');
        const removeAttrsBtn = document.getElementById('removeAttrsBtn');
        const minifyBtn = document.getElementById('minifyBtn');
        const pasteBtn = document.getElementById('pasteBtn');
        const copyBtn = document.getElementById('copyBtn');
        const clearBtn = document.getElementById('clearBtn');
        const resultInfo = document.getElementById('resultInfo');
        const autoStripCheck = document.getElementById('autoStripOnPaste');
        const autoTrimCheck = document.getElementById('autoTrimAfterStrip');
        function showToast(message, variant = 'info') {
            let container = document.querySelector('.toast-container');
            if (!container) {
                container = document.createElement('div');
                container.className = 'toast-container position-fixed bottom-0 end-0 p-3';
                container.style.zIndex = '1100';
                document.body.appendChild(container);
            }
            const toastEl = document.createElement('div');
            toastEl.className = `toast align-items-center text-bg-${variant} border-0`;
            toastEl.setAttribute('role', 'alert');
            toastEl.setAttribute('aria-live', 'assertive');
            toastEl.setAttribute('aria-atomic', 'true');
            const dFlex = document.createElement('div');
            dFlex.className = 'd-flex';
            const toastBody = document.createElement('div');
            toastBody.className = 'toast-body';
            toastBody.textContent = message;
            const closeBtn = document.createElement('button');
            closeBtn.type = 'button';
            closeBtn.className = 'btn-close btn-close-white me-2 m-auto';
            closeBtn.setAttribute('data-bs-dismiss', 'toast');
            closeBtn.setAttribute('aria-label', 'Close');
            dFlex.appendChild(toastBody);
            dFlex.appendChild(closeBtn);
            toastEl.appendChild(dFlex);
            container.appendChild(toastEl);
            const toast = new bootstrap.Toast(toastEl, { delay: 3000 });
            toast.show();
            toastEl.addEventListener('hidden.bs.toast', () => toastEl.remove());
        }
        function stripHTML() {
            const originalValue = mainText.value;
            if (!originalValue.trim()) {
                showToast('Input is empty.', 'info');
                resultInfo.textContent = '';
                return false;
            }
            try {
                const parser = new DOMParser();
                const doc = parser.parseFromString(originalValue, 'text/html');
                doc.querySelectorAll('script, style').forEach(el => el.remove());
                const strippedText = doc.body.textContent || "";
                const charDiff = originalValue.length - strippedText.length;
                mainText.value = strippedText;
                if (charDiff > 0) {
                    resultInfo.textContent = `Removed ${charDiff} character${charDiff !== 1 ? 's' : ''} of HTML.`;
                    showToast('HTML tags removed successfully.', 'success');
                } else {
                    resultInfo.textContent = 'No tags found.';
                    showToast('No HTML tags were found to remove.', 'info');
                }
                mainText.focus();
                return true;
            } catch (error) {
                showToast('An error occurred while stripping HTML.', 'danger');
                resultInfo.textContent = 'Error processing content.';
                return false;
            }
        }
        function trimBlankLines() {
            const originalValue = mainText.value;
            if (!originalValue.trim()) {
                showToast('Input is empty.', 'info');
                return false;
            }
            const trimmedText = originalValue.replace(/(?:\n[ \t]*){3,}/g, '\n\n');
            const charDiff = originalValue.length - trimmedText.length;
            mainText.value = trimmedText;
            if (charDiff > 0) {
                resultInfo.textContent = `Removed ${charDiff} character${charDiff !== 1 ? 's' : ''} from extra blank lines.`;
                showToast('Blank lines trimmed.', 'success');
            } else {
                resultInfo.textContent = 'No extra blank lines found.';
                showToast('No extra blank lines to trim.', 'info');
            }
            mainText.focus();
            return true;
        }
        function removeAllAttributes() {
            const originalValue = mainText.value;
            if (!originalValue.trim()) {
                showToast('Input is empty.', 'info');
                return false;
            }
            try {
                const parser = new DOMParser();
                const doc = parser.parseFromString(originalValue, 'text/html');
                function stripAttrs(node) {
                    if (node.nodeType === 1) {
                        for (let i = node.attributes.length - 1; i >= 0; i--) {
                            node.removeAttribute(node.attributes[i].name);
                        }
                    }
                    for (let child of node.childNodes) {
                        stripAttrs(child);
                    }
                }
                stripAttrs(doc.body);
                mainText.value = doc.body.innerHTML;
                resultInfo.textContent = 'All attributes removed from tags.';
                showToast('All attributes removed.', 'success');
                mainText.focus();
                return true;
            } catch (error) {
                showToast('An error occurred while removing attributes.', 'danger');
                resultInfo.textContent = 'Error processing content.';
                return false;
            }
        }
        function minifyHTML() {
            const originalValue = mainText.value;
            if (!originalValue.trim()) {
                showToast('Input is empty.', 'info');
                return false;
            }
            const minified = originalValue.replace(/\s+/g, ' ').trim();
            mainText.value = minified;
            resultInfo.textContent = 'Whitespace collapsed (minified).';
            showToast('Minified.', 'success');
            mainText.focus();
            return true;
        }
        async function copyText() {
            if (!mainText.value) {
                showToast('Nothing to copy.', 'info');
                return;
            }
            try {
                await navigator.clipboard.writeText(mainText.value);
                showToast('Result copied to clipboard.', 'success');
            } catch (err) {
                showToast('Copy failed.', 'danger');
            }
        }
        async function pasteText() {
            try {
                const text = await navigator.clipboard.readText();
                mainText.value = text;
                resultInfo.textContent = '';
                showToast('Pasted from clipboard.', 'success');
                if (autoStripCheck.checked) {
                    setTimeout(() => {
                        if (stripHTML() && autoTrimCheck.checked) {
                            setTimeout(trimBlankLines, 50);
                        }
                    }, 50);
                } else {
                    mainText.focus();
                }
            } catch (err) {
                showToast('Paste failed. Check permissions.', 'danger');
            }
        }
        function clearText() {
            mainText.value = '';
            resultInfo.textContent = '';
            showToast('Input cleared.', 'info');
            mainText.focus();
        }
        stripBtn.addEventListener('click', () => {
            if (stripHTML() && autoTrimCheck.checked) {
                setTimeout(trimBlankLines, 50);
            }
        });
        trimLinesBtn.addEventListener('click', trimBlankLines);
        removeAttrsBtn.addEventListener('click', removeAllAttributes);
        minifyBtn.addEventListener('click', minifyHTML);
        copyBtn.addEventListener('click', copyText);
        pasteBtn.addEventListener('click', pasteText);
        clearBtn.addEventListener('click', clearText);
        mainText.addEventListener('paste', () => {
            if (autoStripCheck.checked) {
                setTimeout(() => {
                    if (stripHTML() && autoTrimCheck.checked) {
                        setTimeout(trimBlankLines, 50);
                    }
                }, 1);
            }
        });
        mainText.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                stripBtn.click();
            }
        });
    });
    </script>
</body>
</html>
